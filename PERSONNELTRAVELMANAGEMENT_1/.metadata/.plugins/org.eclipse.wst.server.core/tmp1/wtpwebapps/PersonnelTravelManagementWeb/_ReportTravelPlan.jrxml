<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.2.0.final using JasperReports Library version 6.2.0  -->
<!-- 2016-08-08T09:10:01 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="_ReportTravelPlan" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="0" whenResourceMissingType="Empty" uuid="e6b483a2-01c2-4928-a616-707d054be1bb">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="net.sf.jasperreports.print.create.bookmarks" value="false"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="bps_ptms"/>
	<subDataset name="TravelPlanDataset" uuid="f9131d80-e947-4158-ab95-4a7ff1f2ec86">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
		<queryString>
			<![CDATA[]]>
		</queryString>
	</subDataset>
	<parameter name="tono" class="java.lang.String"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false"/>
	<parameter name="tpid" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
	  plan.`tono`,
	   GROUP_CONCAT(tos.nym,'(',IFNULL(tos.department,'None'),')' SEPARATOR ', ') AS nym,
	  DATE(plan.fromdate) AS fromdate,
	  DATE(plan.todate) AS todate,
	  tos.destination,
	  IFNULL(plan.`food`,0.00) AS food,
	  IFNULL(plan.`allowance`,0.00) as allowance,
	  IFNULL(plan.`accommodation`,0.00) as accommodation,
	  IFNULL(plan.`transportation`,0.00) as transportation,
	  IFNULL(plan.`perdiem`,0.00) as perdiem,
	  IFNULL(sv.total,0.00) AS onTravel,
	  (plan.`food` +
	  plan.`allowance`+
	  plan.`accommodation`+
	  plan.`transportation`+
	  plan.`perdiem`+
	  IFNULL(sv.total,0.00)) as grandTotal,
	  stat.`status`,
	  IFNULL(app.nym, 'Not Available')as approver
	FROM `bps_ptms`.`ptms_t_travelplan` AS plan
	INNER JOIN (
	SELECT
	 CONCAT(REPLACE(REPLACE(REPLACE(tos.todate,'-',''),':',''),' ','')) AS tono
	, emp.nym
	, emp.`department`
	, CONCAT(IFNULL(des.`code`,''),' ',IFNULL(des.`state`,''),' ',IFNULL(des.`city`,''),', ',IFNULL(des.`country`,'')) AS destination
	, prior.`priority`
	FROM ptms_t_travelorder AS tos
	INNER JOIN ptms_r_priority AS prior
	ON tos.priorityid = prior.`id`
	LEFT JOIN (SELECT  emp.`id`, CONCAT(emp.`lastname`,', ',emp.`firstname`,' ',emp.`middlename`) AS nym, dept.`department`
	FROM ptms_m_employee AS emp
	INNER JOIN ptms_r_department AS dept
	ON emp.`departmentid` = dept.`id`) AS emp
	ON tos.employeeid = emp.`id`
	INNER JOIN ptms_r_destination AS des
	ON tos.`destinationid` = des.`id`
	WHERE tos.`statusid` = 7
	) AS tos
	ON plan.`tono` = tos.tono
	LEFT JOIN (SELECT approv.id, CONCAT(emp.`lastname`,', ',emp.`firstname`,' ',IFNULL(emp.`middlename`,''),', (',IFNULL(post.`position`,'User'),')' ) AS nym FROM ptms_m_approvingofficer AS approv
	INNER JOIN ptms_m_employee AS emp
	ON approv.employeeid = emp.`id`
	LEFT JOIN ptms_r_position AS post
	ON emp.`positionid` = post.`id`) AS app
	ON plan.officerid = app.id
	INNER JOIN ptms_r_status AS stat
	ON plan.`statusid` = stat.`id`
	LEFT JOIN (
		SELECT lst.travelplanid, (SUM(IFNULL(sv.`amount`,0.00)) + SUM(IFNULL(misc.amount,0.00))) AS total
		FROM ptms_t_travelplanlist AS lst
		LEFT JOIN ptms_m_services AS sv
		ON lst.serviceid = sv.id
		LEFT JOIN ptms_m_miscellaneous misc
		ON lst.`id` = misc.`planlistid`
		GROUP BY lst.travelplanid
	) AS sv
	ON plan.id = sv.travelplanid
	WHERE plan.tono =  $P{tono} AND plan.id =  $P{tpid} 
	GROUP BY plan.id]]>
	</queryString>
	<field name="tono" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nym" class="java.lang.String"/>
	<field name="fromdate" class="java.sql.Date"/>
	<field name="todate" class="java.sql.Date"/>
	<field name="destination" class="java.lang.String"/>
	<field name="food" class="java.math.BigDecimal"/>
	<field name="allowance" class="java.math.BigDecimal"/>
	<field name="accommodation" class="java.math.BigDecimal"/>
	<field name="transportation" class="java.math.BigDecimal"/>
	<field name="perdiem" class="java.math.BigDecimal"/>
	<field name="onTravel" class="java.math.BigDecimal"/>
	<field name="grandTotal" class="java.math.BigDecimal"/>
	<field name="status" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="approver" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="69" splitType="Stretch">
			<frame>
				<reportElement isPrintRepeatedValues="false" mode="Opaque" x="-20" y="0" width="842" height="69" backcolor="#006699" uuid="8771d942-551f-45f1-8b46-7fdb3a8c39e1"/>
				<staticText>
					<reportElement x="1" y="15" width="839" height="26" forecolor="#FFFFFF" uuid="65b37a08-5978-4b1f-b890-bc6c694c2e4c"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="20" isBold="true"/>
					</textElement>
					<text><![CDATA[Business Productivity Solution]]></text>
				</staticText>
				<staticText>
					<reportElement positionType="Float" x="1" y="41" width="801" height="20" forecolor="#FFFFFF" uuid="51a5c058-4526-49fa-a936-b01b8f22ba67"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="14" isBold="false"/>
					</textElement>
					<text><![CDATA[Personnel Travel Management]]></text>
				</staticText>
				<staticText>
					<reportElement positionType="Float" x="600" y="49" width="120" height="20" forecolor="#FFFFFF" uuid="d339572d-9f16-4937-a1d0-a42fde9e21ff"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="14" isBold="false"/>
					</textElement>
					<text><![CDATA[Travel Order No:]]></text>
				</staticText>
				<image scaleImage="FillFrame">
					<reportElement isPrintRepeatedValues="false" x="200" y="0" width="73" height="69" uuid="9d4b2775-49b0-4014-8f1e-0c10e7c01814"/>
					<imageExpression><![CDATA["C:/Users/roco/Desktop/PERSONNELTRAVELMANAGEMENT_1/PersonnelTravelManagementWeb/WebContent/assets/img/BPS_LOGO.png"]]></imageExpression>
				</image>
				<textField>
					<reportElement isPrintRepeatedValues="false" x="719" y="48" width="123" height="17" forecolor="#FFFFFF" uuid="b97ffa46-ac3d-4c9e-8e45-6dbe5908e5f2"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial" size="14" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{tono}]]></textFieldExpression>
				</textField>
			</frame>
		</band>
	</title>
	<pageHeader>
		<band height="28" splitType="Stretch">
			<staticText>
				<reportElement key="" positionType="Float" x="0" y="0" width="802" height="28" forecolor="#050505" uuid="b7c7c9ea-bdc2-48be-803e-df8d66c41c02">
					<printWhenExpression><![CDATA[new Boolean($V{PAGE_NUMBER}.intValue() == 1)]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" size="20" isBold="false"/>
				</textElement>
				<text><![CDATA[Travel Plan]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="193" splitType="Stretch">
			<rectangle>
				<reportElement x="0" y="120" width="802" height="40" isPrintInFirstWholeBand="true" uuid="7964fa76-f707-4faa-b941-644e9a3b34e3"/>
			</rectangle>
			<rectangle>
				<reportElement key="" isPrintRepeatedValues="false" x="0" y="0" width="802" height="120" isPrintInFirstWholeBand="true" uuid="de8bf42f-1537-462c-beb3-7279d9350004"/>
			</rectangle>
			<staticText>
				<reportElement x="15" y="51" width="60" height="20" isPrintInFirstWholeBand="true" uuid="b3de7e64-74a0-42de-ad8c-8a6874b26b1b"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Personnel:]]></text>
			</staticText>
			<staticText>
				<reportElement x="4" y="130" width="56" height="20" uuid="10ad668c-49f8-4925-b152-9e7a9c14fe94"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Accomm:]]></text>
			</staticText>
			<staticText>
				<reportElement x="150" y="130" width="60" height="20" uuid="0b1d811f-15ce-480f-bfc0-ff8f0f48ea3c"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Transpo:]]></text>
			</staticText>
			<staticText>
				<reportElement x="443" y="130" width="34" height="20" uuid="4c5f4baa-8739-40f1-b960-80aac169686f"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Food:]]></text>
			</staticText>
			<staticText>
				<reportElement x="542" y="130" width="56" height="20" uuid="3976cdb2-c40d-4d78-9e53-e58d5c289d5b"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[PerDiem:]]></text>
			</staticText>
			<staticText>
				<reportElement x="302" y="130" width="68" height="20" uuid="99360de2-3441-40af-a2f6-025a05360078"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Allowance:]]></text>
			</staticText>
			<rectangle>
				<reportElement x="0" y="160" width="802" height="30" isPrintInFirstWholeBand="true" backcolor="#E6E6E6" uuid="4eb37b5f-5d3a-4fd6-b790-f6b8b0974e27"/>
			</rectangle>
			<staticText>
				<reportElement x="664" y="130" width="62" height="20" uuid="887bf084-2228-4d57-8f94-886ced0429df"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[On-Travel:]]></text>
			</staticText>
			<textField>
				<reportElement isPrintRepeatedValues="false" x="77" y="54" width="513" height="56" isPrintInFirstWholeBand="true" uuid="59f67a8f-c94c-4f65-84f4-c29a7a552a1a"/>
				<textElement verticalAlignment="Top">
					<font fontName="Arial" size="12" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nym}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="15" y="10" width="70" height="20" isPrintInFirstWholeBand="true" uuid="1b9edc3c-a835-468b-b56f-099764c3de68"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Destination:]]></text>
			</staticText>
			<staticText>
				<reportElement x="15" y="30" width="80" height="20" isPrintInFirstWholeBand="true" uuid="30aba1b9-9295-4b0d-a56b-a22e3f4c150a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Approved By:]]></text>
			</staticText>
			<textField>
				<reportElement x="95" y="30" width="235" height="20" isPrintInFirstWholeBand="true" uuid="fcad0099-522d-441a-9018-a1c056a98008"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{approver}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="590" y="10" width="70" height="20" isPrintInFirstWholeBand="true" uuid="692fbd63-5912-4d15-aad5-d33fbecdf936"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[From Date:]]></text>
			</staticText>
			<staticText>
				<reportElement x="590" y="30" width="50" height="20" isPrintInFirstWholeBand="true" uuid="e7f8dbd7-4e61-49d4-9f0c-714b19baee8a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[To Date:]]></text>
			</staticText>
			<staticText>
				<reportElement x="540" y="165" width="45" height="20" uuid="73c32395-1da4-489d-a666-37b0ddcae417"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Total:]]></text>
			</staticText>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="60" y="130" width="90" height="20" uuid="9117a0da-9ee5-489d-9679-afe7e6a4e282"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{accommodation}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="210" y="130" width="92" height="20" uuid="57281dac-2fbc-4a3b-9ae2-154efa5884ee"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{transportation}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="370" y="130" width="73" height="20" uuid="ee3f2040-8f8c-45a5-b798-a0ced76d06b6"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{allowance}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="477" y="130" width="65" height="20" uuid="e14ad6c7-d899-499e-9609-b1445b0e2e9a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{food}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="598" y="130" width="66" height="20" uuid="83c25801-3581-48ab-8c40-24078dc69b7a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{perdiem}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="726" y="130" width="74" height="20" uuid="d3a5fb76-5fb3-475a-9490-839473d39dbe"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{onTravel}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)" isBlankWhenNull="false">
				<reportElement x="587" y="165" width="130" height="20" uuid="1b7c2bc1-b887-474a-9a8e-702adfa2f9e0"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{grandTotal}]]></textFieldExpression>
			</textField>
			<textField pattern="MMM d, yyyy">
				<reportElement x="662" y="10" width="100" height="20" isPrintInFirstWholeBand="true" uuid="4c2e5551-6db9-4bbc-be10-d80581febb62"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fromdate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="85" y="10" width="485" height="20" isPrintInFirstWholeBand="true" uuid="8f9771f2-ecec-4a19-aa21-02ef841d4168"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{destination}]]></textFieldExpression>
			</textField>
			<textField pattern="MMM d, yyyy">
				<reportElement x="661" y="30" width="100" height="20" isPrintInFirstWholeBand="true" uuid="bde4b80e-9af9-4343-80c7-8936835ae96a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{todate}]]></textFieldExpression>
			</textField>
		</band>
		<band height="32">
			<subreport>
				<reportElement key="" positionType="Float" x="0" y="0" width="802" height="20" uuid="4c10e006-660c-43b5-ac28-a41786a5cbdf"/>
				<subreportParameter name="tono">
					<subreportParameterExpression><![CDATA[$P{tono}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="tpid">
					<subreportParameterExpression><![CDATA[$P{tpid}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA["../../_ReportTravelPlanSubreport.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
