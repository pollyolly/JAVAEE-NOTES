<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.2.0.final using JasperReports Library version 6.2.0  -->
<!-- 2016-06-18T12:53:32 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Plan" pageWidth="100" pageHeight="30" columnWidth="100" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="b82237b4-120d-4a48-a711-822bac37d6bf">
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<parameter name="tono" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT 
	  plan.`tono`,
	  stat.`status`,
	  (plan.`food` +
	  plan.`allowance` +
	  plan.`accommodation` +
	  plan.`transportation` +
	  plan.`perdiem` +
	  sv.total)AS total
	FROM `bps_ptms`.`ptms_t_travelplan` AS plan
	INNER JOIN (
	SELECT
	 CONCAT(REPLACE(REPLACE(REPLACE(tos.todate,'-',''),':',''),' ','')) AS tono
	FROM ptms_t_travelorder AS tos
	WHERE tos.`statusid` = 7
	) AS tos
	ON plan.`tono` = tos.tono
	INNER JOIN ptms_r_status AS stat
	ON plan.`statusid` = stat.`id`
	LEFT JOIN (
		SELECT lst.`tono`, SUM(sv.`amount`) AS total
		FROM ptms_t_travelplanlist AS lst
		LEFT JOIN ptms_m_services AS sv
		ON lst.serviceid = sv.id
		GROUP BY lst.tono
	) AS sv
	ON plan.`tono` = sv.tono
	WHERE plan.tono = $P{tono}   AND stat.`id` = 7
	GROUP BY plan.tono]]>
	</queryString>
	<field name="tono" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="status" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="total" class="java.math.BigDecimal"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="29" splitType="Stretch">
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="0" y="0" width="100" height="29" uuid="adb48839-4af3-480f-b68d-ed69d1f6b000"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
