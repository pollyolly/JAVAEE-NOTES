<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.2.0.final using JasperReports Library version 6.2.0  -->
<!-- 2016-04-11T11:14:20 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="_ReportTravelExpense" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="d00013b4-f585-4aeb-8185-575129007d2c">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="bps_ptms"/>
	<subDataset name="TravelExpenseDataset" uuid="66511dd6-f386-406c-bebb-d8215d30e73b">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
		<queryString>
			<![CDATA[]]>
		</queryString>
	</subDataset>
	<parameter name="odid" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[SELECT tos.id ,tos.`tono`, 
CONCAT(tos.nym,'(',IFNULL(tos.department,'None'),')') AS nym,
 xp.`fromdate`, xp.`todate`, tos.destination, 
 IFNULL(app.nym,'Not Available') as approver, 
 stat.`status`
, IFNULL(ca.amnt, 0.00) AS ca
, IFNULL(reimb.amnt, 0.00) AS reimb
, IFNULL(nonreimb.amnt,0.00) AS nonreimb
FROM ptms_t_travelexpense AS xp
INNER JOIN (
	SELECT
	tos.`id`
	, CONCAT(REPLACE(REPLACE(REPLACE(tos.todate,'-',''),':',''),' ','')) AS tono
	, emp.nym
	, emp.`department`
	, CONCAT(IFNULL(des.`code`,''),' ',IFNULL(des.`state`,''),' ',IFNULL(des.`city`,''),', ',IFNULL(des.`country`,'')) AS destination
	FROM ptms_t_travelorder AS tos
	LEFT JOIN (SELECT  emp.`id`, CONCAT(emp.`lastname`,', ',emp.`firstname`,' ',emp.`middlename`) AS nym, dept.`department`
	FROM ptms_m_employee AS emp
	INNER JOIN ptms_r_department AS dept
	ON emp.`departmentid` = dept.`id`) AS emp
	ON tos.employeeid = emp.`id`
	INNER JOIN ptms_r_destination AS des
	ON tos.`destinationid` = des.`id`
	INNER JOIN ptms_r_status as stat
	ON tos.statusid = stat.id
	WHERE stat.`status` = 'Approved'
	) AS tos
	ON tos.id = xp.`orderid`
	LEFT JOIN (SELECT approv.id, CONCAT(emp.`lastname`,', ',emp.`firstname`,' ',IFNULL(emp.`middlename`,''),', (',IFNULL(post.`position`,'User'),')' ) AS nym FROM ptms_m_approvingofficer AS approv
	INNER JOIN ptms_m_employee AS emp
	ON approv.employeeid = emp.`id`
	LEFT JOIN ptms_r_position AS post
	ON emp.`positionid` = post.`id`) AS app
	ON xp.`officerid` = app.id
	INNER JOIN ptms_r_status AS stat
	ON xp.`statusid` = stat.`id`
	LEFT JOIN (SELECT ca.`orderid`, SUM(IFNULL(ca.`amount`,0.00)) AS amnt FROM ptms_t_cashadvance AS ca
		INNER JOIN ptms_r_status as stat
		ON ca.statusid = stat.id
		 WHERE stat.`status` = 'Approved'
	GROUP BY ca.`orderid`) AS ca
	ON xp.`orderid` = ca.orderid
	LEFT JOIN (SELECT orderid, SUM(IFNULL(amount,0.00)) AS amnt FROM ptms_t_travelexpenselist WHERE reimburse > 0 GROUP BY orderid) AS reimb
	ON xp.`orderid` = reimb.orderid
	LEFT JOIN (SELECT orderid, SUM(IFNULL(amount,0.00)) AS amnt FROM ptms_t_travelexpenselist WHERE reimburse < 1 GROUP BY orderid) AS nonreimb
	ON xp.`orderid` = nonreimb.orderid
	WHERE xp.`orderid` =  $P{odid}]]>
	</queryString>
	<field name="id" class="java.lang.Integer"/>
	<field name="tono" class="java.lang.String"/>
	<field name="nym" class="java.lang.String"/>
	<field name="fromdate" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="todate" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="destination" class="java.lang.String"/>
	<field name="approver" class="java.lang.String"/>
	<field name="status" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ca" class="java.math.BigDecimal"/>
	<field name="reimb" class="java.math.BigDecimal"/>
	<field name="nonreimb" class="java.math.BigDecimal"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="79" splitType="Stretch">
			<frame>
				<reportElement mode="Opaque" x="-20" y="0" width="842" height="72" backcolor="#006699" uuid="da8c462f-6286-4f85-8f1f-3263037463a4"/>
				<staticText>
					<reportElement x="1" y="15" width="841" height="26" forecolor="#FFFFFF" uuid="52399f3b-e673-4a55-b2af-44db988adf76"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="20" isBold="true"/>
					</textElement>
					<text><![CDATA[Business Productivity Solution]]></text>
				</staticText>
				<staticText>
					<reportElement positionType="Float" x="1" y="41" width="841" height="19" forecolor="#FFFFFF" uuid="0886788c-5fb8-4f85-a8d6-0b12d2bf4542"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="14" isBold="false"/>
					</textElement>
					<text><![CDATA[Personnel Travel Management]]></text>
				</staticText>
				<image scaleImage="FillFrame">
					<reportElement x="200" y="0" width="73" height="72" uuid="5918dbab-3a0a-440c-a195-696c970c33bf"/>
					<imageExpression><![CDATA["C:/Users/roco/Desktop/PERSONNELTRAVELMANAGEMENT_1/PersonnelTravelManagementWeb/WebContent/assets/img/BPS_LOGO.png"]]></imageExpression>
				</image>
				<staticText>
					<reportElement positionType="Float" x="600" y="50" width="120" height="20" forecolor="#FFFFFF" uuid="80d36220-d151-4395-8865-6c6617a16489"/>
					<textElement textAlignment="Center">
						<font size="14" isBold="false"/>
					</textElement>
					<text><![CDATA[Travel Order No:]]></text>
				</staticText>
				<textField>
					<reportElement x="720" y="50" width="120" height="21" forecolor="#FFFFFF" uuid="3e5466e2-968d-4a7e-8514-d669d42706f1"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Arial" size="14" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{tono}]]></textFieldExpression>
				</textField>
			</frame>
		</band>
	</title>
	<pageHeader>
		<band height="35" splitType="Stretch">
			<staticText>
				<reportElement key="" positionType="Float" isPrintRepeatedValues="false" x="-20" y="2" width="840" height="28" isPrintInFirstWholeBand="true" forecolor="#050505" uuid="a9c61980-89a1-4688-bf86-8fe44dc13bf5">
					<printWhenExpression><![CDATA[new Boolean($V{PAGE_NUMBER}.intValue() == 1)]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="20" isBold="false"/>
				</textElement>
				<text><![CDATA[Travel Expense]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="168" splitType="Stretch">
			<rectangle>
				<reportElement x="450" y="0" width="352" height="100" uuid="8a7247d0-940a-428f-b04a-c2fb87c2f6a9"/>
			</rectangle>
			<rectangle>
				<reportElement x="0" y="0" width="500" height="100" uuid="a804d01d-9fa5-43ba-a62a-0f9e46e428a7"/>
			</rectangle>
			<staticText>
				<reportElement x="320" y="30" width="70" height="20" uuid="ba9c415a-3a8e-4e63-8ddc-7a8e6c50d55e"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[From Date:]]></text>
			</staticText>
			<staticText>
				<reportElement x="320" y="50" width="50" height="20" uuid="8e551a1d-312e-42f3-8d12-40fce0b1c313"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[To Date:]]></text>
			</staticText>
			<staticText>
				<reportElement x="27" y="10" width="63" height="20" uuid="030f0fee-16e9-4fe2-956b-17d8caac5e96"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Personnel:]]></text>
			</staticText>
			<staticText>
				<reportElement x="10" y="30" width="80" height="20" uuid="02ef325c-06ff-4363-b15c-c9a3d8e1d152"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Approved By:]]></text>
			</staticText>
			<staticText>
				<reportElement x="510" y="10" width="90" height="20" uuid="673db824-88db-4ab2-a7e6-d3dd101359bd"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Cash Advance:]]></text>
			</staticText>
			<staticText>
				<reportElement x="510" y="30" width="86" height="20" uuid="e432452d-cf61-4d6e-81dc-d6ec977a131b"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Reimbursable:]]></text>
			</staticText>
			<staticText>
				<reportElement x="510" y="50" width="114" height="20" uuid="cde3a68e-718a-407a-ad4f-aa904175d43d"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Non-Reimbursable:]]></text>
			</staticText>
			<rectangle>
				<reportElement x="0" y="100" width="802" height="30" backcolor="#D1D1D1" uuid="04f07ab9-588c-42e3-9aae-071915f8865d"/>
			</rectangle>
			<staticText>
				<reportElement x="493" y="105" width="87" height="20" uuid="8d9094fc-f984-4a7a-912e-c858a928e8d8"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Total Expense:]]></text>
			</staticText>
			<staticText>
				<reportElement x="20" y="50" width="70" height="20" uuid="319a9f64-55da-49a0-8516-fb702427de51"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Destination:]]></text>
			</staticText>
			<textField>
				<reportElement x="90" y="10" width="330" height="20" uuid="bd45b99a-22b8-4467-bef8-860052f0734e"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nym}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="90" y="30" width="210" height="20" uuid="9cc06831-70f9-4fe9-bf3d-d506b615d58a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{approver}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="90" y="54" width="210" height="40" uuid="094389ae-1000-4752-9123-51b0388db60e"/>
				<textElement verticalAlignment="Top">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{destination}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="624" y="50" width="143" height="20" uuid="507f4bb8-8ebf-421e-897c-e191f5e2ec3d"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nonreimb}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="600" y="30" width="130" height="20" uuid="f4912997-dfde-4de5-9c83-ad30d2e4b902"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{reimb}]]></textFieldExpression>
			</textField>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="600" y="10" width="83" height="20" uuid="fcd47d21-c994-472c-b26e-b3655d7e8873"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ca}]]></textFieldExpression>
			</textField>
			<textField pattern="MMM, dd, YYYY">
				<reportElement x="390" y="30" width="80" height="20" uuid="5f7818bd-ab63-4f3d-8a1d-c920b38752c6"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fromdate}]]></textFieldExpression>
			</textField>
			<textField pattern="MMM, dd, YYYY">
				<reportElement x="390" y="50" width="80" height="20" uuid="69ce9071-9402-4ed5-8213-5258a9156928"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{todate}]]></textFieldExpression>
			</textField>
			<subreport>
				<reportElement x="0" y="136" width="802" height="25" uuid="40db2572-c266-4f8a-b00d-8835c6b22a97"/>
				<subreportParameter name="odid">
					<subreportParameterExpression><![CDATA[$P{odid}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA["../../_ReportTravelExpenseSubreport.jasper"]]></subreportExpression>
			</subreport>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="580" y="105" width="85" height="20" uuid="cdd6b6a2-34b3-41e3-b40e-3996d39d6182"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{reimb}.doubleValue() + $F{nonreimb}.doubleValue() + 0.00]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="665" y="105" width="47" height="20" uuid="3dc4d569-370e-4aae-b517-11c0fdbc5d7f"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Return:]]></text>
			</staticText>
			<textField pattern="P #,##0.00#;(#,##0.00#)">
				<reportElement x="713" y="105" width="83" height="20" uuid="997c429e-51f0-4f3d-9e57-f8b3282dce99"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ca}.doubleValue() > $F{reimb}.doubleValue()?
$F{ca}.doubleValue() - $F{reimb}.doubleValue() +0.00:
0.00]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
